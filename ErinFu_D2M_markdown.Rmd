---
title             : "Unveiling the Impact of Adult Emotion on Child Learning Motivation"
shorttitle        : "Emotion and Motivation"

author: 
  - name          : "Yuzhen Fu"
    affiliation   : "1"
    corresponding : yes    # Define only one corresponding author
    address       : "Postal address"
    email         : "my@email.com"
    role: # Contributorship roles (e.g., CRediT, https://credit.niso.org/)
      - "Conceptualization"
      - "Writing - Original Draft Preparation"
      - "Writing - Review & Editing"
  - name          : "Ernst-August Doelle"
    affiliation   : "1,2"
    role:
      - "Writing - Review & Editing"
      - "Supervision"

affiliation:
  - id            : "1"
    institution   : "Wilhelm-Wundt-University"
  - id            : "2"
    institution   : "Konstanz Business School"

authornote: |
  Add complete departmental affiliations for each author here. Each new line herein must be indented, like this line.

  Enter author note here.

abstract: |
  One or two sentences providing a **basic introduction** to the field,  comprehensible to a scientist in any discipline.
  Two to three sentences of **more detailed background**, comprehensible  to scientists in related disciplines.
  One sentence clearly stating the **general problem** being addressed by  this particular study.
  One sentence summarizing the main result (with the words "**here we show**" or their equivalent).
  Two or three sentences explaining what the **main result** reveals in direct comparison to what was thought to be the case previously, or how the  main result adds to previous knowledge.
  One or two sentences to put the results into a more **general context**.
  Two or three sentences to provide a **broader perspective**, readily comprehensible to a scientist in any discipline.
  
  <!-- https://tinyurl.com/ybremelq -->
  
keywords          : "keywords"
wordcount         : "X"

bibliography      : "r-references.bib"

floatsintext      : no
linenumbers       : yes
draft             : no
mask              : no

figurelist        : no
tablelist         : no
footnotelist      : no

classoption       : "man"
output            : papaja::apa6_pdf
---

```{r setup, include = FALSE}
# load the papaja package
library("papaja")
source("Erinfu_D2M_helloworld().R")
r_refs("r-references.bib")
```

``` {r library packages}
library(readr)
library(tidyverse)

install.packages("extrafont")
library(extrafont)
font_import()
fonts <- windowsFonts()
print(fonts)
```

``` {r call the helloworld}
class_group <- c("Anna", "Ben", "Erin")
hello_world(class_group)
```

``` {r read dataset csv}
EM_dataset <- read.csv("data/ErinFu_Dataset_E&M_1114-1206.csv")
# Yes, it is tidy!
# Each column is a single variable
# Each row is a single observation
# Each cell is a single measurement
# Absolutely necessary: The columns that record the result of our 6-point scale, which tests the relationship between emotion and motivation (e.g., Surprise.important)
# Likely extraneous: Duration, Child.Birthday, Parent.Education, Family.Income, Note
```

``` {r intermediate dataset}
EM_dataset.edited <- EM_dataset %>%
  rename(Duration = Duration..in.seconds.) %>%
  filter(Finished == "TRUE") %>%
  select(-c(Duration, Child.Birthday, Parent.1.Education, Parent.2.Education, Family.Income, Note))
write_csv(EM_dataset.edited, "data/ErinFu_dataset_E&M_0117.csv")
```

``` {r data preparation}
EM_dataset_wide <- read.csv("data/ErinFu_Dataset_E&M_1114-0125.csv")
EM_dataset_long <- EM_dataset_wide %>%
  pivot_longer(cols = c("Surprise.Important", "Surprise.Interesting", "Surprise.Difficulty", "Surprise.Motivation", "Awe.Important", "Awe.Interesting", "Awe.Difficulty", "Awe.Motivation", "Enjoyment.Important", "Enjoyment.Interesting", "Enjoyment.Difficulty", "Enjoyment.Motivation", "Neutral.Important", "Neutral.Interesting", "Neutral.Difficulty", "Neutral.Motivation", "Fear.Important", "Fear.Interesting", "Fear.Difficulty", "Fear.Motivation", "Sadness.Important", "Sadness.Interesting", "Sadness.Difficulty", "Sadness.Motivation"), 
               names_to = "Name", 
               values_to = "Result") %>%
  separate_wider_delim(Name,
                       delim = ".",
                      names = c("Emotion", "Scale_Type")) %>%
  separate_wider_delim(Result,
                       delim = ".",
                      names = c("Score", "Note"))
write_csv(EM_dataset_long, "data/ErinFu_dataset_E&M_0125.csv")
```

``` {r plot1 age-in-years}
# Show me the distribution of age-in-years of participants in a density plot
# The number of participants in each age should be similar
ggplot(EM_dataset_long, aes(Child.Age.In.Years)) + geom_density()
```

``` {r plot2 enjoyment-motivation}
# Show me the distribution of Score when Emotion = Enjoyment and Scale_Type = Motivation in a bar plot
# The distribution of score can reflect that if the expressed emotion is "Enjoyment", how children's motivation level gonna looks like
filtered_data_1 <- subset(EM_dataset_long, Emotion == "Enjoyment" & Scale_Type == "Motivation")
ggplot(filtered_data_1, aes(Score)) + geom_bar()
# It seems like children gonna have high learning motivation when adults express "Enjoyment" to a specific subject
```

``` {r plot3 mean-motivation}
EM_dataset_long$Score <- as.numeric(EM_dataset_long$Score)
EM_dataset_long %>%
  subset(Scale_Type == "Motivation") %>%
  group_by(Emotion) %>%
  summarise(mean_Score = mean(Score)) %>%
ggplot(aes(x = Emotion, y = mean_Score, fill = Emotion)) +
  geom_col() +
  geom_jitter(data = EM_dataset_long, aes(x = Emotion, y = Score), width = .1, height = .1, color = "grey")
```

``` {r plot3 mean-motivation2.0(AS12)}
# using boxplot to show the spread and maen of data
EM_dataset_long$Score <- as.numeric(EM_dataset_long$Score)
EM_dataset_long %>%
  subset(Scale_Type == "Motivation") %>%
  group_by(Emotion) %>%
ggplot(aes(x = Emotion, y = Score, fill = Emotion)) +
  geom_boxplot() +
  coord_cartesian(xlim = c(0,8), ylim = c(0,7))
```

``` {r plot4 emotion-motivation(AS12)}
# using violin plot and dotplot to show the distribution of data
EM_dataset_long$Score <- as.numeric(EM_dataset_long$Score)
EM_dataset_long %>%
  subset(Scale_Type == "Motivation") %>%
  group_by(Emotion) %>%
ggplot(aes(x = Emotion, y = Score, fill = Emotion)) +
  geom_violin() +
  coord_cartesian(xlim = c(0,7), ylim = c(0,7)) +
  geom_dotplot(binaxis = "y", stackdir = "center", dotsize = 0.5, color = "black", fill = "grey")
```

``` {r plot1 emotion-motivation(AS13) fig.cap = "Adult's Emotions and Children's Learning Motivation"}
EM_dataset_long$Score <- as.numeric(EM_dataset_long$Score)
EM_dataset_long %>%
  subset(Scale_Type == "Motivation") %>%
  group_by(Emotion) %>%
ggplot(aes(x = Emotion, y = Score, fill = Emotion)) +
  geom_violin() +
  coord_cartesian(xlim = c(0,7), ylim = c(0,7)) +
  scale_y_continuous(breaks = seq(1, 6, by = 1)) +
  geom_dotplot(binaxis = "y", stackdir = "center", dotsize = 0.6, color = "black", fill = "grey") +
  labs(title = "The Relationship between Adult's Emotions and Children's Learning Motivation", x = "Emotion", y = "Motivation Levels") +
  theme(
    text = element_text(family = "Times New Roman"),
    panel.grid.minor.y = element_blank(),
    panel.grid.major.x = element_line(linetype = 2, size = 0.6),
    panel.grid.major.y = element_line(linetype = 2, size = 0.6)
  )
```

``` {r plot2 age-emotion-motivation(AS13) fig.cap = "Children's Age and Learning Motivation Grouped by Emotions"}
EM_dataset_long$Score <- as.numeric(EM_dataset_long$Score)
EM_dataset_long %>%
  subset(Scale_Type == "Motivation") %>%
  group_by(Emotion) %>%
ggplot(aes(x = Child.Age.In.Years, y = Score)) +
  geom_smooth(method = "lm") +
  facet_wrap(.~Emotion, scales = "free_x") +
  scale_y_continuous(breaks = seq(1, 6, by = 1)) +
  geom_point() +
  labs(title = "The Relationship between Children's Age and Learning Motivation", subtitle = 'Grouped by Six Different Emotions', x = "Children's Age (in years)", y = "Motivation Levels") +
  theme(
    text = element_text(family = "Times New Roman"),
    panel.grid.minor.y = element_blank()
  )
```

``` {r AS13 read-in picture}
library(png)

image_path_1 <- "data/E&M_DemonstratePicture_1.png"
image <- readPNG(image_path_1)

plot(1:2, type = "n", xlab = "", ylab = "", xlim = c(0, 1), ylim = c(0, 1))
rasterImage(image, 0, 0, 1, 1)
```

```{r analysis-preferences}
# Seed for random number generation
set.seed(42)
knitr::opts_chunk$set(cache.extra = knitr::rand_seed)
```



# Methods
We report how we determined our sample size, all data exclusions (if any), all manipulations, and all measures in the study. <!-- 21-word solution (Simmons, Nelson & Simonsohn, 2012; retrieved from http://ssrn.com/abstract=2160588) -->

## Participants
### Phrase 1  
The recruit goal for phrase one is 100 participants. _Qualtrics_ is used to conduct the recruitment ([https://www.qualtrics.com/](url)).  
There are three *exclusive conditions* for participants:  
* Condition 1  
* Condition 2  
  * Sub-Condition 2.1  
  * Sub-Condition 2.2  
* Condition 3  

### Phrase 2
The recruit goal for phrase two is 20 participants.  
**List of dataset**  
1. Dataset 1  
2. Dataset 2  
3. Dataset 3  
The dataset were saved by **_Google Drive_**.  
<!-- https://www.google.com/drive/ -->  

## Procedure

## Data analysis
We used `r cite_r("r-references.bib")` for all our analyses.


# Results

# Discussion


\newpage

# References

::: {#refs custom-style="Bibliography"}
:::
